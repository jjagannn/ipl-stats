{"ast":null,"code":"import _objectSpread from\"/Users/jagannathan/Excellence/sample-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/jagannathan/Excellence/sample-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/jagannathan/Excellence/sample-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";var _excluded=[\"component\"];import React,{useState,useEffect}from\"react\";import{BrowserRouter as Router,Switch,Route,Link,Redirect}from\"react-router-dom\";import{login,useAuth,authFetch,logout}from\"./auth\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PrivateRoute=function PrivateRoute(_ref){var Component=_ref.component,rest=_objectWithoutProperties(_ref,_excluded);var _useAuth=useAuth(),_useAuth2=_slicedToArray(_useAuth,1),logged=_useAuth2[0];return/*#__PURE__*/_jsx(Route,_objectSpread(_objectSpread({},rest),{},{render:function render(props){return logged?/*#__PURE__*/_jsx(Component,_objectSpread({},props)):/*#__PURE__*/_jsx(Redirect,{to:\"/login\"});}}));};export default function App(){return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"nav\",{children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"Home\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"Login\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/secret\",children:\"Secret\"})})]})}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{path:\"/login\",children:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(PrivateRoute,{path:\"/secret\",component:Secret}),/*#__PURE__*/_jsx(Route,{path:\"/\",children:/*#__PURE__*/_jsx(Home,{})})]})]})});}function Home(){useEffect(function(){fetch(\"/api\").then(function(resp){return resp.json();}).then(function(resp){return console.log(resp);});},[]);return/*#__PURE__*/_jsx(\"h2\",{children:\"Home\"});}function Login(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var onSubmitClick=function onSubmitClick(e){e.preventDefault();console.log(\"You pressed login\");var opts={'username':username,'password':password};console.log(opts);fetch('/api/login',{method:'post',body:JSON.stringify(opts)}).then(function(r){return r.json();}).then(function(token){if(token.access_token){login(token);console.log(token);}else{console.log(\"Please type in correct username/password\");}});};var handleUsernameChange=function handleUsernameChange(e){setUsername(e.target.value);};var handlePasswordChange=function handlePasswordChange(e){setPassword(e.target.value);};var _useAuth3=useAuth(),_useAuth4=_slicedToArray(_useAuth3,1),logged=_useAuth4[0];return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),!logged?/*#__PURE__*/_jsxs(\"form\",{action:\"#\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Username\",onChange:handleUsernameChange,value:username})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",onChange:handlePasswordChange,value:password})}),/*#__PURE__*/_jsx(\"button\",{onClick:onSubmitClick,type:\"submit\",children:\"Login Now\"})]}):/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return logout();},children:\"Logout\"})]});}function Secret(){var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),message=_useState6[0],setMessage=_useState6[1];useEffect(function(){authFetch(\"/api/protected\").then(function(response){if(response.status===401){setMessage(\"Sorry you aren't authorized!\");return null;}return response.json();}).then(function(response){if(response&&response.message){setMessage(response.message);}});},[]);return/*#__PURE__*/_jsxs(\"h2\",{children:[\"Secret: \",message]});}","map":{"version":3,"sources":["/Users/jagannathan/Excellence/sample-app/src/App.js"],"names":["React","useState","useEffect","BrowserRouter","Router","Switch","Route","Link","Redirect","login","useAuth","authFetch","logout","PrivateRoute","Component","component","rest","logged","props","App","Secret","Home","fetch","then","resp","json","console","log","Login","username","setUsername","password","setPassword","onSubmitClick","e","preventDefault","opts","method","body","JSON","stringify","r","token","access_token","handleUsernameChange","target","value","handlePasswordChange","message","setMessage","response","status"],"mappings":"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","sourcesContent":["import React, { useState,useEffect } from \"react\";\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link,\n  Redirect\n} from \"react-router-dom\";\nimport { login, useAuth, authFetch, logout } from \"./auth\";\n\nconst PrivateRoute = ({ component: Component, ...rest }) => {\n  const [logged] = useAuth();\n\n  return <Route {...rest} render={(props) => (\n    logged\n      ? <Component {...props} />\n      : <Redirect to='/login' />\n  )} />\n}\n\nexport default function App() {\n  return (\n    <Router>\n      <div>\n        <nav>\n          <ul>\n            <li>\n              <Link to=\"/\">Home</Link>\n            </li>\n            <li>\n              <Link to=\"/login\">Login</Link>\n            </li>\n            <li>\n              <Link to=\"/secret\">Secret</Link>\n            </li>\n          </ul>\n        </nav>\n\n        {/* A <Switch> looks through its children <Route>s and\n            renders the first one that matches the current URL. */}\n        <Switch>\n          <Route path=\"/login\">\n            <Login />\n          </Route>\n          <PrivateRoute path=\"/secret\" component={Secret} />\n          <Route path=\"/\">\n            <Home />\n          </Route>\n        </Switch>\n      </div>\n    </Router>\n  );\n}\n\nfunction Home() {\n  useEffect(() => {\n    fetch(\"/api\").then(resp => resp.json()).then(resp => console.log(resp))\n  }, [])\n  return <h2>Home</h2>;\n}\n\nfunction Login() {\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n\n  const onSubmitClick = (e)=>{\n    e.preventDefault()\n    console.log(\"You pressed login\")\n    let opts = {\n      'username': username,\n      'password': password\n    }\n    console.log(opts)\n    fetch('/api/login', {\n      method: 'post',\n      body: JSON.stringify(opts)\n    }).then(r => r.json())\n      .then(token => {\n        if (token.access_token){\n          login(token)\n          console.log(token)          \n        }\n        else {\n          console.log(\"Please type in correct username/password\")\n        }\n      })\n  }\n\n  const handleUsernameChange = (e) => {\n    setUsername(e.target.value)\n  }\n\n  const handlePasswordChange = (e) => {\n    setPassword(e.target.value)\n  }\n  const [logged] = useAuth();\n\nreturn (\n  <div>\n    <h2>Login</h2>\n    {!logged? <form action=\"#\">\n      <div>\n        <input type=\"text\" \n          placeholder=\"Username\" \n          onChange={handleUsernameChange}\n          value={username} \n        />\n      </div>\n      <div>\n        <input\n          type=\"password\"\n          placeholder=\"Password\"\n          onChange={handlePasswordChange}\n          value={password}\n        />\n      </div>\n      <button onClick={onSubmitClick} type=\"submit\">\n        Login Now\n      </button>\n    </form>\n    : <button onClick={() => logout()}>Logout</button>}\n  </div>\n)\n}\n\nfunction Secret() {\n  const [message, setMessage] = useState('')\n\n  useEffect(() => {\n    authFetch(\"/api/protected\").then(response => {\n      if (response.status === 401){\n        setMessage(\"Sorry you aren't authorized!\")\n        return null\n      }\n      return response.json()\n    }).then(response => {\n      if (response && response.message){\n        setMessage(response.message)\n      }\n    })\n  }, [])\n  return (\n    <h2>Secret: {message}</h2>\n  )\n}"]},"metadata":{},"sourceType":"module"}